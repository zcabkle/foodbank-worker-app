"'Graphs Page' As screen":
    OnVisible: |
        =ClearCollect(
            colItemsChart,
            {
                ShortDate: "",
                In: 0,
                Out: 0
            }
        );
        ForAll(
            colSumOfIncomingRecords As Record,
            Patch(
                colItemsChart,
                Defaults(colItemsChart),
                {
                    ShortDate: Record.ShortDate,
                    In: Record.'Sum of Incoming',
                    Out: 0
                }
            )
        );
        ForAll(
            colSumOfOutgoingRecords As Record,
            If(
                CountRows(
                    Filter(
                        colItemsChart,
                        ShortDate = Text(Record.ShortDate)
                    )
                ) > 0,
                Patch(
                    colItemsChart,
                    LookUp(
                        colItemsChart,
                        ShortDate = Text(Record.ShortDate)
                    ),
                    {Out: Record.'Sum of Outgoing'}
                ),
                Patch(
                    colItemsChart,
                    Defaults(colItemsChart),
                    {
                        ShortDate: Record.ShortDate,
                        In: 0,
                        Out: Record.'Sum of Outgoing'
                    }
                )
            )
        );
        Remove(colItemsChart, LookUp(colItemsChart, ShortDate = ""));

    CompositeLineChart1 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =17

        Title6 As label:
            Align: =Align.Center
            FontWeight: =FontWeight.Semibold
            Height: =26
            Text: ="Visits at " & LookUp(Foodbanks, FoodbankPK = SelectedFoodbank).Name
            Width: =611
            X: =14
            Y: =76
            ZIndex: =18

        LineChart1 As lineChart:
            Font: =Font.'Open Sans'
            Height: =418
            Items: =colDisplayedVisits
            NumberOfSeries: =4
            Size: =15
            Width: =611
            X: =14
            Y: =91
            ZIndex: =19

        Legend2 As legend:
            Height: =55
            ItemColorSet: =LineChart1.ItemColorSet
            Items: =LineChart1.SeriesLabels
            Size: =16
            Width: =550
            X: =37
            Y: =518
            ZIndex: =20

    "'Appbar Cmpnt_8' As 'Appbar Cmpnt'":
        Y: =1036
        ZIndex: =21

    "'Topbar Cmpnt_9' As 'Topbar Cmpnt'":
        ZIndex: =22

    Button15 As button:
        Height: =59
        OnSelect: |
            =ClearCollect(
                colItemsChart,
                {
                    ShortDate: "",
                    In: 0,
                    Out: 0
                }
            );
            ForAll(
                colSumOfIncomingRecords As Record,
                Patch(
                    colItemsChart,
                    Defaults(colItemsChart),
                    {
                        ShortDate: Record.ShortDate,
                        In: Record.'Sum of Incoming',
                        Out: 0
                    }
                )
            );
            ForAll(
                colSumOfOutgoingRecords As Record,
                If(
                    CountRows(
                        Filter(
                            colItemsChart,
                            ShortDate = Text(Record.ShortDate)
                        )
                    ) > 0,
                    Patch(
                        colItemsChart,
                        LookUp(
                            colItemsChart,
                            ShortDate = Text(Record.ShortDate)
                        ),
                        {Out: Record.'Sum of Outgoing'}
                    ),
                    Patch(
                        colItemsChart,
                        Defaults(colItemsChart),
                        {
                            ShortDate: Record.ShortDate,
                            In: 0,
                            Out: Record.'Sum of Outgoing'
                        }
                    )
                )
            );
            Remove(colItemsChart, LookUp(colItemsChart, ShortDate = ""));
        Size: =24
        Text: ="Button"
        Width: =127
        X: =513
        Y: =60
        ZIndex: =23

    CompositeLineChart3 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =24

        Title9 As label:
            Align: =Align.Center
            FontWeight: =FontWeight.Semibold
            Height: =21
            Text: ="Items In - Items Out at " & LookUp(Foodbanks, FoodbankPK = SelectedFoodbank).Name
            Width: =618
            X: =22
            Y: =597
            ZIndex: =25

        LineChart3 As lineChart:
            Font: =Font.'Open Sans'
            Height: =341
            Items: =colItemsChart
            NumberOfSeries: =2
            Width: =618
            X: =22
            Y: =618
            ZIndex: =26

        Legend5 As legend:
            Height: =68
            ItemColorSet: =LineChart3.ItemColorSet
            Items: =LineChart3.SeriesLabels
            Size: =16
            Width: =495
            X: =85
            Y: =968
            ZIndex: =27

